# Guía de Instalación y Evolución de FreeIPA para la Fábrica de Software: De Desarrollo a Producción
(por validar)

Dr. Jesús Zavala Ruiz[^1]

*10 de frebrero de 2026* 

---

## Introducción

Esta guía detalla el procedimiento para instalar y configurar un servidor FreeIPA en los entornos de desarrollo, pruebas y producción de una fábrica de software simulada. Su objetivo es proporcionar un camino claro y seguro para escalar la plataforma de identidad desde un entorno efímero hasta uno robusto y listo para producción, siguiendo las mejores prácticas documentadas para sistemas RHEL-derivados [[2]].

## Principios Generales de Gestión por Entornos

La gestión de FreeIPA a través de múltiples entornos (DEV, TEST, PROD) debe regirse por los siguientes principios:
1.  **Aislamiento Total:** Cada entorno debe operar en su propio dominio DNS y reino Kerberos.
2.  **Flujo Unidireccional:** La promoción de configuraciones y políticas debe seguir un flujo estricto de DEV → TEST → PROD, nunca al revés.
3.  **Automatización:** Todas las instalaciones y configuraciones deben ser reproducibles mediante scripts o herramientas de infraestructura como código (IaC).
4.  **Gestión de Secretos:** Las contraseñas y claves criptográficas deben gestionarse de forma segura y diferenciada en cada entorno.

## Guía de Instalación por Entorno

### Entorno de Desarrollo (DEV)

El entorno de desarrollo está diseñado para la experimentación rápida y la iteración ágil. La seguridad es importante, pero la velocidad y la facilidad de uso son prioritarias.

**Objetivos:**
*   Aislamiento del resto de la infraestructura.
*   Facilidad de destrucción y recreación.
*   Soporte para pruebas rápidas de integración.

**Configuración Específica:**
*   **Dominio:** `dev.example.com.mx`
*   **Reino Kerberos:** `DEV.EXAMPLE.COM.MX`
*   **Hostname del Servidor:** `ipa-dev.dev.example.com.mx`
*   **Certificados:** Autofirmados.
*   **DNS:** Integrado con zonas de avance a servidores públicos (e.g., `8.8.8.8`).

**Comando de Instalación:**
```bash
sudo ipa-server-install \
  --domain=dev.example.com.mx \
  --realm=DEV.EXAMPLE.COM.MX \
  --hostname=ipa-dev.dev.example.com.mx \
  --setup-dns \
  --forwarder=8.8.8.8 \
  --no-reverse \
  --unattended \
  --admin-password='DevPassw0rd!' \
  --ds-password='DevPassw0rd!'
```

**Recomendaciones para DEV:**
*   **Infraestructura:** Ejecutar en contenedores LXC o máquinas virtuales efímeras.
*   **Copias de Seguridad:** No son estrictamente necesarias; el entorno se puede recrear desde cero.
*   **Usuarios:** Crear usuarios y grupos de prueba directamente en la consola web o CLI para pruebas rápidas.

---

### Entorno de Pruebas (TEST)

El entorno de pruebas es un espejo controlado del entorno de producción. Aquí se validan todas las configuraciones, políticas y flujos de trabajo antes de su promoción.

**Objetivos:**
*   Simular fielmente la configuración de producción.
*   Validar la integración con todas las aplicaciones del stack (PostgreSQL, Mayan EDMS, iDempiere).
*   Probar los procedimientos de recuperación ante desastres.

**Configuración Específica:**
*   **Dominio:** `test.example.com.mx`
*   **Reino Kerberos:** `TEST.EXAMPLE.COM.MX`
*   **Hostname del Servidor:** `ipa-test.test.example.com.mx`
*   **Certificados:** Autofirmados, pero con una estructura de CA que simule la de producción.
*   **DNS:** Integrado, con posibilidad de configurar zonas internas si es necesario para las pruebas.

**Comando de Instalación:**
```bash
sudo ipa-server-install \
  --domain=test.example.com.mx \
  --realm=TEST.EXAMPLE.COM.MX \
  --hostname=ipa-test.test.example.com.mx \
  --setup-dns \
  --forwarder=8.8.8.8 \
  --no-reverse \
  --unattended \
  --admin-password='TestPassw0rd!' \
  --ds-password='TestPassw0rd!'
```

**Recomendaciones para TEST:**
*   **Infraestructura:** Usar máquinas virtuales o instancias en la nube con almacenamiento persistente.
*   **Copias de Seguridad:** Implementar un plan de copias de seguridad regular (por ejemplo, diario) para probar los procedimientos de restauración.
*   **Gobernanza:** Todo cambio en TEST debe provenir de una promoción formal desde DEV, documentada y aprobada.
*   **Pruebas de Integración:** Realizar pruebas exhaustivas de autenticación y autorización con todas las aplicaciones del stack.

---

### Entorno de Producción Inicial (PROD)

El entorno de producción es el sistema real que gestiona las identidades de los usuarios finales. La seguridad, la disponibilidad y la integridad de los datos son la máxima prioridad.

**Objetivos:**
*   Alta disponibilidad y resiliencia.
*   Seguridad reforzada y conformidad con las políticas corporativas.
*   Monitoreo y alertas proactivas.

**Configuración Específica:**
*   **Dominio:** `example.com.mx` (o el dominio corporativo real, como `uamizt.mx`).
*   **Reino Kerberos:** `EXAMPLE.COM.MX`.
*   **Hostname del Servidor:** `ipa-prod01.example.com.mx`.
*   **Certificados:** Firmados por una Autoridad de Certificación (CA) institucional o pública de confianza.
*   **DNS:** Integrado, con configuración completa de zonas directas e inversas, y replicación con servidores DNS corporativos si es necesario.

**Comando de Instalación (Inicial):**
```bash
sudo ipa-server-install \
  --domain=example.com.mx \
  --realm=EXAMPLE.COM.MX \
  --hostname=ipa-prod01.example.com.mx \
  --setup-dns \
  --forwarder=192.168.1.1 \ # Usar DNS corporativo
  --forwarder=192.168.1.2 \
  --unattended \
  --admin-password='<Contraseña_Segura_y_Gestionada>' \
  --ds-password='<Contraseña_Segura_y_Gestionada>'
```

**Recomendaciones Críticas para PROD:**
1.  **Alta Disponibilidad (HA):** La configuración inicial de un solo servidor es solo el primer paso. **Inmediatamente después de la instalación inicial, se debe configurar un segundo servidor réplica para lograr alta disponibilidad.** El comando `ipa-replica-install` se utiliza para este propósito. La pérdida del único servidor de producción resultaría en una interrupción total de todos los servicios que dependen de él.
2.  **Gestión de Secretos:** Las contraseñas de `admin` y `Directory Manager` deben generarse de forma segura, almacenarse en un gestor de secretos (como HashiCorp Vault o un sistema equivalente) y rotarse periódicamente.
3.  **Certificados:** Los certificados autofirmados no son aceptables en producción. Se deben solicitar y configurar certificados válidos para todos los servicios (HTTP, LDAP over SSL, etc.).
4.  **Monitoreo:** Integrar el servidor FreeIPA con el sistema de monitoreo corporativo (por ejemplo, Prometheus, Zabbix, Nagios) para supervisar la salud del servicio, el uso de disco, la latencia de LDAP y los eventos de seguridad.
5.  **Auditoría y Logs:** Configurar el envío de logs de auditoría a un sistema centralizado de gestión de eventos de seguridad (SIEM) para su análisis y cumplimiento normativo.
6.  **Políticas de Contraseña:** Aplicar políticas de contraseña corporativas estrictas inmediatamente después de la instalación, en lugar de usar las políticas predeterminadas.

---
**Fuente:** La guía se basa en la documentación oficial y ejemplos de configuración para Rocky Linux 10, tal como se describe en Server World [[2]].
---
[^1]: Profesor-investigador del Departamento de Economía de la Universidad Autónoma Metropolitana, Unidad Iztapalapa. email: [jzr@xanum.uam.mx](mailto:jzr@xanum.uam.mx), [https://t.me/jzavalar](https://t.me/jzavalar).
