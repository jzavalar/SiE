# PostgreSQL: Instalación, Integración con FreeIPA y Orquestación con Ansible
(para revisión)

Dr. Jesús Zavala Ruiz[^1]

11 de Febrero de 2026

---

## Introducción

PostgreSQL representa el motor de datos soberano por excelencia para sistemas críticos como un **Sistema de información Empresarial (SiE)**. Como señala Brodie (2019), el proyecto Postgres de la Universidad de California en Berkeley sentó las bases para lo que posteriormente se convertiría en "PostgreSQL and Beyond" (p. 311), evolucionando desde un prototipo académico a una plataforma empresarial de código abierto. Esta guía proporciona un enfoque progresivo en tres etapas fundamentales:

1.  **Instalación básica** de PostgreSQL 16 en Rocky Linux 10
2.  **Integración con FreeIPA** para autenticación centralizada y gestión de identidades
3.  **Orquestación con Ansible** para automatización, reproducibilidad y soberanía operativa

Cada etapa construye sobre la anterior, garantizando una implementación segura, escalable y alineada con los principios de soberanía tecnológica.

## Parte 1: Instalación Básica de PostgreSQL 16 en Rocky Linux 10

### Fundamentos Tecnológicos

PostgreSQL es un sistema de gestión de bases de datos relacional (RDBMS) de código abierto que implementa el modelo relacional descrito por Edgar F. Codd. Su arquitectura se distingue por:

*   **Modelo de procesos**: A diferencia de otros motores que utilizan hilos (*threads*), PostgreSQL crea un nuevo proceso del sistema operativo para cada conexión de cliente. Este diseño ofrece mayor estabilidad, ya que un fallo en un cliente no afecta a otros ni al proceso principal del servidor (Smyth, 2023).
*   **Cumplimiento ACID**: PostgreSQL garantiza Atomicidad, Consistencia, Aislamiento y Durabilidad en todas las transacciones, asegurando la integridad de los datos incluso ante fallos del sistema.
*   **Extensibilidad**: Permite definir tipos de datos personalizados, operadores y funciones, transformando la base de datos en una plataforma verdaderamente adaptable a las necesidades del negocio.

### Procedimiento de Instalación Paso a Paso

#### Requisitos Previos
```bash
# 1. Actualizar el sistema operativo
sudo dnf update -y

# 2. Verificar versión de Rocky Linux
cat /etc/rocky-release
# Debe mostrar: Rocky Linux release 10.x

# 3. Verificar espacio en disco mínimo (2 GB recomendado)
df -h /var/lib/pgsql
```

#### Paso 1: Habilitar el Repositorio Oficial de PostgreSQL
Rocky Linux 10 no incluye las versiones más recientes de PostgreSQL en sus repositorios base. Es necesario habilitar el repositorio mantenido por el proyecto PostgreSQL:

```bash
# Instalar el repositorio RPM oficial
sudo dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-10-x86_64/pgdg-redhat-repo-latest.noarch.rpm

# Deshabilitar el módulo postgresql de AppStream para evitar conflictos
sudo dnf -qy module disable postgresql
```

> **Nota técnica:** El repositorio `pgdg-redhat-repo` proporciona paquetes binarios oficialmente mantenidos por el equipo de PostgreSQL, garantizando estabilidad y compatibilidad con RHEL/Rocky Linux, tal como describe Smyth (2023) en su análisis de la gestión de paquetes en entornos empresariales.

#### Paso 2: Instalar PostgreSQL 16 y Componentes Esenciales
```bash
# Instalar el servidor PostgreSQL 16 y herramientas complementarias
sudo dnf install -y postgresql16-server postgresql16-contrib postgresql16-llvmjit

# Verificar la instalación
rpm -qa | grep postgresql16
```

#### Paso 3: Inicializar el Cluster de Bases de Datos
```bash
# Inicializar el directorio de datos (data directory)
sudo /usr/pgsql-16/bin/postgresql-16-setup initdb

# Verificar que el directorio se creó correctamente
ls -la /var/lib/pgsql/16/data/
```

> **ADVERTENCIA DE SEGURIDAD:** El directorio `/var/lib/pgsql/16/data/` contiene todos los datos de la base de datos y debe tener permisos estrictos (`postgres:postgres`, `700`). Cualquier cambio en estos permisos puede comprometer la seguridad del sistema, como señala Smyth (2023) en su tratamiento de las políticas de SELinux y seguridad en Rocky Linux.

#### Paso 4: Configuración Inicial de Seguridad
Editar el archivo `pg_hba.conf` para establecer una política de autenticación segura:

```bash
# Hacer copia de seguridad
sudo cp /var/lib/pgsql/16/data/pg_hba.conf /var/lib/pgsql/16/data/pg_hba.conf.backup

# Configuración mínima segura para entorno inicial
sudo tee /var/lib/pgsql/16/data/pg_hba.conf > /dev/null << 'EOF'
# TYPE  DATABASE        USER            ADDRESS                 METHOD
# Conexiones locales
local   all             all                                     peer
# Conexiones IPv4 locales
host    all             all             127.0.0.1/32            scram-sha-256
# Conexiones IPv6 locales
host    all             all             ::1/128                 scram-sha-256
# RESTRINGIR acceso remoto hasta completar configuración de seguridad
host    all             all             0.0.0.0/0               reject
EOF
```

#### Paso 5: Iniciar el Servicio y Configurar el Firewall
```bash
# Habilitar e iniciar el servicio
sudo systemctl enable --now postgresql-16

# Verificar estado
sudo systemctl status postgresql-16

# Configurar firewall para PostgreSQL (puerto 5432)
sudo firewall-cmd --permanent --add-service=postgresql
sudo firewall-cmd --reload

# Verificar que el puerto está escuchando
sudo ss -tulpn | grep 5432
```

#### Paso 6: Configuración del Usuario `postgres` y Primer Acceso
```bash
# Cambiar al usuario postgres del sistema
sudo -i -u postgres

# Acceder a la consola de PostgreSQL
psql

# Dentro de psql, cambiar la contraseña del superusuario
ALTER USER postgres PASSWORD 'Contraseña_Segura_y_Compleja_2026!';

# Crear una base de datos de prueba para el SiE
CREATE DATABASE sie_empresarial OWNER postgres ENCODING 'UTF8' 
  LC_COLLATE 'es_MX.UTF-8' LC_CTYPE 'es_MX.UTF-8' TEMPLATE template0;

# Salir de psql
\q

# Salir del usuario postgres
exit
```

#### Paso 7: Prueba de Funcionamiento Básico
```bash
# Conectarse a la base de datos del SiE como usuario postgres
psql -U postgres -d sie_empresarial

# Ejecutar consulta de prueba
SELECT version();

# Crear tabla de ejemplo para el SiE
CREATE TABLE empleados (
    id SERIAL PRIMARY KEY,
    nombre TEXT NOT NULL,
    departamento TEXT NOT NULL,
    fecha_contratacion DATE DEFAULT CURRENT_DATE
);

# Insertar registro de prueba
INSERT INTO empleados (nombre, departamento) 
VALUES ('Ana García', 'Recursos Humanos');

# Consultar los datos
SELECT * FROM empleados;

# Salir de psql
\q
```

### Checklist de Verificación Post-Instalación
- [ ] Servicio PostgreSQL 16 activo y habilitado en el arranque
- [ ] Puerto 5432 accesible localmente pero restringido remotamente
- [ ] Contraseña del usuario `postgres` cambiada y segura
- [ ] Archivo `pg_hba.conf` configurado con métodos de autenticación seguros (`scram-sha-256`)
- [ ] Firewall configurado para permitir tráfico PostgreSQL solo desde redes autorizadas
- [ ] SELinux en modo enforcing y políticas de PostgreSQL aplicadas correctamente
- [ ] Prueba de conexión local exitosa
- [ ] Base de datos del SiE creada con codificación UTF8 y locale español

---

## Parte 2: Integración con FreeIPA para Autenticación Centralizada

### Fundamentos Tecnológicos

FreeIPA es una solución de gestión de identidades de código abierto que integra múltiples tecnologías estándar:

*   **LDAP (389 Directory Server)**: Almacena los datos de identidad en un directorio jerárquico.
*   **Kerberos (MIT Kerberos)**: Proporciona autenticación de red segura mediante tickets, eliminando la transmisión de contraseñas en texto plano.
*   **DNS (BIND)**: Gestiona la resolución de nombres y publica registros SRV para el descubrimiento automático de servicios.
*   **PKI (Dogtag Certificate System)**: Actúa como Autoridad de Certificación para emitir certificados X.509.

La integración de PostgreSQL con FreeIPA permite delegar la autenticación al dominio corporativo, eliminando la gestión local de contraseñas y centralizando el control de acceso bajo el principio de soberanía tecnológica.

### Procedimiento de Integración Paso a Paso

#### Requisito Previo: Enrolamiento del Servidor en FreeIPA
El servidor PostgreSQL debe estar previamente enrolado en el dominio FreeIPA:

```bash
# Instalar cliente FreeIPA
sudo dnf install -y freeipa-client

# Enrolar en el dominio corporativo (ejemplo para dominio example.com.mx)
sudo ipa-client-install \
  --domain=example.com.mx \
  --server=ipa-prod01.example.com.mx \
  --realm=EXAMPLE.COM.MX \
  --mkhomedir \
  --unattended \
  --principal admin \
  --password 'Contraseña_Admin_FreeIPA'
```

#### Paso 1: Creación del Principal de Servicio en FreeIPA
Desde un cliente con credenciales administrativas de FreeIPA:

```bash
# Autenticarse como administrador
kinit admin

# Crear el principal de servicio para PostgreSQL
ipa service-add postgres/db-prod01.example.com.mx

# Verificar creación
ipa service-show postgres/db-prod01.example.com.mx
```

#### Paso 2: Generación y Transferencia del Keytab
El keytab contiene las claves criptográficas que permiten la autenticación Kerberos sin contraseña:

```bash
# En el servidor FreeIPA, generar el keytab
ipa-getkeytab -s ipa-prod01.example.com.mx \
  -p postgres/db-prod01.example.com.mx \
  -k /tmp/postgres.keytab

# Transferir al servidor PostgreSQL mediante SCP seguro
scp /tmp/postgres.keytab root@db-prod01.example.com.mx:/etc/postgresql.keytab

# En el servidor PostgreSQL, ajustar permisos
sudo chown postgres:postgres /etc/postgresql.keytab
sudo chmod 600 /etc/postgresql.keytab
```

#### Paso 3: Configuración de Autenticación GSSAPI en PostgreSQL
Editar el archivo `pg_hba.conf` para habilitar la autenticación Kerberos:

```bash
sudo tee -a /var/lib/pgsql/16/data/pg_hba.conf > /dev/null << 'EOF'

# Autenticación GSSAPI/Kerberos para usuarios del dominio corporativo
# TYPE  DATABASE        USER            ADDRESS                 METHOD
host    all             all             192.168.10.0/24         gss include_realm=0
EOF
```

> **Explicación técnica:** El método `gss` utiliza el API GSSAPI (Generic Security Services Application Program Interface) para autenticación Kerberos. El parámetro `include_realm=0` evita que el nombre del reino (`@EXAMPLE.COM.MX`) se incluya en el nombre de usuario de PostgreSQL, simplificando la gestión de roles.

#### Paso 4: Configuración del Mapeo de Usuarios
Crear el archivo `pg_ident.conf` para mapear usuarios de Kerberos a roles de PostgreSQL:

```bash
sudo tee /var/lib/pgsql/16/data/pg_ident.conf > /dev/null << 'EOF'
# MAPNAME       SYSTEM-USERNAME         PG-USERNAME
sie_map         /^(.*)@EXAMPLE\.COM\.MX$  \1
EOF
```

Luego, actualizar `pg_hba.conf` para usar este mapeo:
```
host    all             all             192.168.10.0/24         gss include_realm=0 map=sie_map
```

#### Paso 5: Creación de Roles Basados en Grupos de FreeIPA
```bash
# Conectarse como superusuario
sudo -u postgres psql -d sie_empresarial

-- Crear roles que coincidan con grupos de FreeIPA
CREATE ROLE sie_users NOLOGIN;          -- Grupo base para todos los usuarios
CREATE ROLE sie_admins NOINHERIT;       -- Administradores del SiE
CREATE ROLE finanzas NOINHERIT;         -- Departamento de finanzas
CREATE ROLE rrhh NOINHERIT;             -- Departamento de recursos humanos

-- Otorgar privilegios básicos a sie_users
GRANT CONNECT ON DATABASE sie_empresarial TO sie_users;
GRANT USAGE ON SCHEMA public TO sie_users;

-- Otorgar acceso a tablas específicas por departamento
GRANT SELECT ON empleados TO rrhh;
GRANT SELECT, INSERT, UPDATE ON salarios TO finanzas;

-- Asignar usuarios a roles (ejemplo)
GRANT sie_users TO ana.garcia;
GRANT rrhh TO ana.garcia;

-- Salir de psql
\q
```

#### Paso 6: Prueba de Autenticación Kerberos
Desde un cliente Linux enrolado en FreeIPA:

```bash
# Obtener un ticket Kerberos como usuario ana.garcia
kinit ana.garcia@EXAMPLE.COM.MX
Password for ana.garcia@EXAMPLE.COM.MX: ********

# Verificar el ticket
klist

# Conectarse a PostgreSQL sin proporcionar contraseña
psql -h db-prod01.example.com.mx -U ana.garcia -d sie_empresarial

# Si la conexión es exitosa, aparecerá el prompt de psql
sie_empresarial=>
```

### Beneficios de la Integración para la Soberanía Tecnológica

1.  **Eliminación del vendor lock-in**: Al usar estándares abiertos (LDAP, Kerberos), la organización no depende de un proveedor propietario para la gestión de identidades.
2.  **Control total sobre los datos**: El código fuente de FreeIPA y PostgreSQL es auditables, permitiendo verificar que no existen puertas traseras o mecanismos de vigilancia.
3.  **Autonomía operativa**: La organización puede gestionar, modificar y extender ambas plataformas según sus necesidades específicas, sin restricciones de licencia.
4.  **Interoperabilidad garantizada**: Al basarse en estándares de la industria, la integración funciona con cualquier cliente que soporte GSSAPI/Kerberos, incluyendo aplicaciones Java, Python y .NET.

## Parte 3: Orquestación con Ansible para Gestión de Infraestructura como Código

### Fundamentos Tecnológicos

Ansible es una herramienta de automatización de código abierto que permite gestionar la configuración de sistemas mediante **Infraestructura como Código (IaC)**. Su arquitectura se distingue por:

*   **Agenteless**: No requiere agentes instalados en los nodos gestionados; utiliza SSH para la comunicación.
*   **Idempotencia**: Los playbooks de Ansible pueden ejecutarse múltiples veces sin efectos secundarios, garantizando que el sistema alcance siempre el estado deseado.
*   **Declarativo**: Los administradores describen el estado final deseado del sistema, no los pasos para alcanzarlo.
*   **Extensible**: Permite crear módulos personalizados en cualquier lenguaje de programación.

Esta filosofía de IaC es fundamental para la soberanía tecnológica, ya que transforma la infraestructura en código versionable, auditables y reproducible, eliminando la "configuración manual" y la dependencia de conocimiento tribal.

### Arquitectura Propuesta para el SiE

```
+---------------------+
|   Ansible Control   |
|      Node           |
|  (git repository)   |
+----------+----------+
           |
           | SSH
           v
+----------+----------+     +------------------+     +------------------+
|   PostgreSQL        |     |   PostgreSQL     |     |   PostgreSQL     |
|   Maestro (PROD)    |<--->|   Réplica 1      |<--->|   Réplica 2      |
|  db-prod01          |     |  db-prod02       |     |  db-prod03       |
+---------------------+     +------------------+     +------------------+
           ^                         ^                       ^
           |                         |                       |
    +------+-----+           +-------+------+         +------+-------+
    |  FreeIPA   |           |   FreeIPA    |         |   FreeIPA    |
    |  Server    |           |   Replica    |         |   Replica    |
    +------------+           +--------------+         +--------------+
```

### Implementación Paso a Paso

#### Paso 1: Configuración del Nodo de Control de Ansible
```bash
# Instalar Ansible en el nodo de control (puede ser una estación de trabajo o servidor dedicado)
sudo dnf install -y ansible-core git

# Crear estructura de directorios para el proyecto del SiE
mkdir -p ~/sie-ansible/{inventories,playbooks,templates,files,roles}
cd ~/sie-ansible

# Inicializar repositorio Git para versionar toda la infraestructura
git init
git config user.name "Administrador SiE"
git config user.email "sie-admin@example.com.mx"
```

#### Paso 2: Creación del Inventario de Ansible
```ini
# inventories/prod/hosts.ini
[prod_db_servers]
db-prod01.example.com.mx ansible_host=192.168.10.10
db-prod02.example.com.mx ansible_host=192.168.10.11
db-prod03.example.com.mx ansible_host=192.168.10.12

[prod_db_servers:vars]
ansible_user=root
ansible_become=yes
pg_version=16
pg_port=5432
freeipa_domain=example.com.mx
freeipa_realm=EXAMPLE.COM.MX
vip_address=192.168.10.100
```

#### Paso 3: Playbook para Instalación y Configuración de PostgreSQL
```yaml
# playbooks/postgresql-install.yml
---
- name: Instalar y configurar PostgreSQL 16 en servidores del SiE
  hosts: prod_db_servers
  become: yes
  vars:
    pg_data_dir: "/var/lib/pgsql/{{ pg_version }}/data"

  tasks:
    - name: Habilitar repositorio oficial de PostgreSQL
      yum_repository:
        name: pgdg{{ pg_version }}
        description: PostgreSQL {{ pg_version }} for RHEL/Rocky $releasever - $basearch
        baseurl: https://download.postgresql.org/pub/repos/yum/{{ pg_version }}/redhat/rhel-10-$basearch
        gpgcheck: yes
        gpgkey: https://www.postgresql.org/media/keys/ACCC4CF8.asc
        enabled: yes

    - name: Deshabilitar módulo postgresql de AppStream
      command: dnf -qy module disable postgresql
      args:
        warn: false

    - name: Instalar paquetes de PostgreSQL {{ pg_version }}
      dnf:
        name:
          - "postgresql{{ pg_version }}-server"
          - "postgresql{{ pg_version }}-contrib"
          - "postgresql{{ pg_version }}-llvmjit"
        state: present

    - name: Inicializar cluster de PostgreSQL (solo en primer nodo)
      command: "/usr/pgsql-{{ pg_version }}/bin/postgresql-{{ pg_version }}-setup initdb"
      args:
        creates: "{{ pg_data_dir }}/PG_VERSION"
      when: inventory_hostname == groups['prod_db_servers'][0]

    - name: Configurar postgresql.conf con parámetros de producción
      template:
        src: templates/postgresql-prod.conf.j2
        dest: "{{ pg_data_dir }}/postgresql.conf"
        owner: postgres
        group: postgres
        mode: '0640'

    - name: Configurar pg_hba.conf para autenticación GSSAPI
      template:
        src: templates/pg_hba-prod.conf.j2
        dest: "{{ pg_data_dir }}/pg_hba.conf"
        owner: postgres
        group: postgres
        mode: '0640'

    - name: Configurar pg_ident.conf para mapeo de usuarios
      template:
        src: templates/pg_ident.conf.j2
        dest: "{{ pg_data_dir }}/pg_ident.conf"
        owner: postgres
        group: postgres
        mode: '0640'

    - name: Habilitar e iniciar servicio PostgreSQL
      systemd:
        name: "postgresql-{{ pg_version }}"
        enabled: yes
        state: started

    - name: Configurar firewall para PostgreSQL
      firewalld:
        port: "{{ pg_port }}/tcp"
        permanent: yes
        state: enabled
        immediate: yes
```

Template `templates/postgresql-prod.conf.j2`:
```ini
listen_addresses = '*'
port = {{ pg_port }}
max_connections = 300
shared_buffers = 4GB
effective_cache_size = 12GB
work_mem = 64MB
maintenance_work_mem = 1GB
wal_level = replica
max_wal_senders = 10
max_replication_slots = 10
wal_keep_size = 2GB
synchronous_commit = on
synchronous_standby_names = '*'
log_destination = 'syslog'
logging_collector = off
log_min_duration_statement = 500
log_checkpoints = on
log_connections = on
log_disconnections = on
log_lock_waits = on
password_encryption = scram-sha-256
ssl = on
ssl_cert_file = '/etc/pki/tls/certs/postgresql.crt'
ssl_key_file = '/etc/pki/tls/private/postgresql.key'
```

Template `templates/pg_hba-prod.conf.j2`:
```conf
# Conexiones locales
local   all             postgres                                peer
local   all             all                                     scram-sha-256

# Conexiones desde red corporativa con autenticación GSSAPI
host    all             all             192.168.10.0/24         gss include_realm=0 map=sie_map

# Conexiones desde réplicas para replicación
host    replication     replicator      192.168.10.0/24         scram-sha-256

# RECHAZAR TODO LO DEMÁS
host    all             all             0.0.0.0/0               reject
```

#### Paso 4: Playbook para Integración con FreeIPA
```yaml
# playbooks/freeipa-integration.yml
---
- name: Integrar servidores PostgreSQL con FreeIPA para autenticación centralizada
  hosts: prod_db_servers
  become: yes
  vars_prompt:
    - name: freeipa_admin_password
      prompt: "Contraseña del administrador de FreeIPA"
      private: yes

  tasks:
    - name: Instalar cliente FreeIPA
      dnf:
        name: freeipa-client
        state: present

    - name: Enrolar servidor en dominio FreeIPA
      command: |
        ipa-client-install --domain={{ freeipa_domain }} \
          --server=ipa-prod01.{{ freeipa_domain }} \
          --server=ipa-prod02.{{ freeipa_domain }} \
          --realm={{ freeipa_realm }} \
          --mkhomedir --unattended \
          --principal admin --password '{{ freeipa_admin_password }}'
      args:
        creates: /etc/ipa/default.conf
      no_log: true

    - name: Crear keytab para servicio PostgreSQL en FreeIPA
      command: |
        ipa-getkeytab -s ipa-prod01.{{ freeipa_domain }} \
          -p postgres/{{ ansible_fqdn }} \
          -k /etc/postgresql.keytab
      args:
        creates: /etc/postgresql.keytab
      register: keytab_result
      failed_when: keytab_result.rc != 0 and "'already exists' not in keytab_result.stderr"

    - name: Ajustar permisos del keytab
      file:
        path: /etc/postgresql.keytab
        owner: postgres
        group: postgres
        mode: '0600'

    - name: Configurar systemd para usar keytab
      copy:
        dest: /etc/systemd/system/postgresql-{{ pg_version }}.service.d/kerberos.conf
        content: |
          [Service]
          Environment=KRB5_KTNAME=/etc/postgresql.keytab
          User=postgres
          Group=postgres
        owner: root
        group: root
        mode: '0644'

    - name: Recargar configuración de systemd
      systemd:
        daemon_reload: yes

    - name: Reiniciar PostgreSQL para aplicar cambios
      systemd:
        name: "postgresql-{{ pg_version }}"
        state: restarted
```

#### Paso 5: Playbook para Gestión de Roles y Permisos del SiE
```yaml
# playbooks/sie-roles.yml
---
- name: Crear roles y permisos para el Sistema de información Empresarial
  hosts: prod_db_servers
  become: yes
  vars:
    sie_database: "sie_empresarial"
    sie_roles:
      - name: "sie_users"
        options: "NOLOGIN"
        grants:
          - "CONNECT ON DATABASE {{ sie_database }}"
          - "USAGE ON SCHEMA public"
      - name: "sie_admins"
        options: "NOINHERIT"
        grants:
          - "ALL PRIVILEGES ON DATABASE {{ sie_database }}"
      - name: "finanzas"
        options: "NOINHERIT"
        grants:
          - "SELECT, INSERT, UPDATE ON salarios"
      - name: "rrhh"
        options: "NOINHERIT"
        grants:
          - "SELECT ON empleados"

  tasks:
    - name: Crear roles del SiE
      postgresql_user:
        name: "{{ item.name }}"
        role_attr_flags: "{{ item.options }}"
        login_user: postgres
        db: "{{ sie_database }}"
      loop: "{{ sie_roles }}"

    - name: Otorgar privilegios a roles
      postgresql_query:
        db: "{{ sie_database }}"
        login_user: postgres
        query: "{{ item.1 }}"
      loop: "{{ sie_roles | subelements('grants') }}"
      loop_control:
        label: "{{ item.0.name }} -> {{ item.1 }}"
```

#### Paso 6: Ejecución de los Playbooks
```bash
# Ejecutar playbook de instalación
ansible-playbook -i inventories/prod/hosts.ini playbooks/postgresql-install.yml

# Ejecutar playbook de integración con FreeIPA
ansible-playbook -i inventories/prod/hosts.ini playbooks/freeipa-integration.yml

# Ejecutar playbook de gestión de roles del SiE
ansible-playbook -i inventories/prod/hosts.ini playbooks/sie-roles.yml
```

### Beneficios de Ansible para la Soberanía Tecnológica

1.  **Reproducibilidad total**: Cada configuración está codificada en playbooks versionados en Git, eliminando la "configuración manual" y el riesgo de "nieve especial" (servidores únicos que nadie entiende).
2.  **Auditoría completa**: Todos los cambios en la infraestructura quedan registrados en el historial de Git, permitiendo rastrear quién hizo qué cambio y cuándo.
3.  **Independencia de proveedores**: Al no depender de interfaces gráficas propietarias o APIs cerradas, la organización mantiene el control total sobre su infraestructura.
4.  **Capacitación interna**: Ansible tiene una curva de aprendizaje relativamente baja y utiliza YAML, un formato legible por humanos, facilitando la capacitación del personal interno.
5.  **Integración con el stack**: Ansible gestiona no solo PostgreSQL, sino también los servidores de aplicaciones (Mayan EDMS, iDempiere) y la plataforma de identidad (FreeIPA), creando una visión unificada de la infraestructura del SiE.

## Conclusión

La combinación de **PostgreSQL**, **FreeIPA** y **Ansible** forma un triángulo tecnológico que garantiza la soberanía sobre los tres pilares críticos de cualquier Sistema de información Empresarial:

| Pilar | Tecnología | Soberanía Garantizada |
| :--- | :--- | :--- |
| **Datos** | PostgreSQL | Control total sobre la integridad, disponibilidad y seguridad de los datos críticos del negocio. Código auditables y sin vendor lock-in. |
| **Identidad** | FreeIPA | Gestión autónoma de usuarios, políticas de acceso y autenticación sin dependencia de proveedores externos. |
| **Infraestructura** | Ansible | Automatización reproducible de toda la configuración, eliminando la dependencia de conocimiento tribal y garantizando consistencia. |

Como señala Brodie (2019), el legado de Stonebraker con Postgres demostró que "el software de código abierto puede alcanzar y superar la calidad de las alternativas propietarias" (p. 318). Esta filosofía se extiende hoy a todo el stack tecnológico del SiE: Rocky Linux para el sistema operativo, FreeIPA para la identidad, PostgreSQL para los datos y Ansible para la orquestación. Juntos, forman un ecosistema coherente, interoperable y soberano que permite a cualquier organización —pública o privada— construir sistemas críticos con total autonomía tecnológica.

### Referencias

Brodie, M. L. (Ed.). (2019). *Making databases work: The pragmatic wisdom of Michael Stonebraker*. Association for Computing Machinery.

FreeIPA. (n.d.). *FreeIPA - Identity, Policy, Audit*. https://www.freeipa.org/

PostgreSQL Global Development Group. (2024). *PostgreSQL 16 documentation*. https://www.postgresql.org/docs/16/

PostgreSQL Global Development Group. (2024). *Download PostgreSQL for Red Hat Enterprise Linux*. https://www.postgresql.org/download/linux/redhat/

Red Hat. (2024). *Red Hat Enterprise Linux 10 Release Notes*. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/10/html/10_release_notes/index

Smyth, N. (2023). *Rocky Linux 9 essentials*. Payload Media, Inc.

Smyth, N. (2023). *Red Hat Enterprise Linux 9 essentials*. Payload Media, Inc.

---
[^1]: Profesor-investigador del Departamento de Economía de la Universidad Autónoma Metropolitana, Unidad Iztapalapa. email: [jzr@xanum.uam.mx](mailto:jzr@xanum.uam.mx), [https://t.me/jzavalar](https://t.me/jzavalar).
